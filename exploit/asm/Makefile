CC		= xcrun -sdk iphoneos clang
OBJCOPY	= /opt/homebrew/opt/binutils/bin/gobjcopy
CFLAGS	= -target arm64-apple-darwin -Wall
			
.PHONY: all

all:
	$(CC) $(CFLAGS) checkm8_arm64.s -o checkm8_arm64.o
	$(OBJCOPY) -O binary -j .text checkm8_arm64.o checkm8_arm64.bin
	-$(RM) checkm8_arm64.o
	xxd -i checkm8_arm64.bin > checkm8_arm64.h
	
	$(CC) $(CFLAGS) usb_0xA1_2_arm64.s -o usb_0xA1_2_arm64.o
	$(OBJCOPY) -O binary -j .text usb_0xA1_2_arm64.o usb_0xA1_2_arm64.bin
	-$(RM) usb_0xA1_2_arm64.o
	xxd -i usb_0xA1_2_arm64.bin > usb_0xA1_2_arm64.h
	
	$(CC) $(CFLAGS) patch_rom.s -o patch_rom.o
	$(OBJCOPY) -O binary -j .text patch_rom.o patch_rom.bin
	-$(RM) patch_rom.o
	xxd -i patch_rom.bin > patch_rom.h
	
clean:
	-$(RM) checkm8_arm64.bin
	-$(RM) checkm8_arm64.o
	-$(RM) checkm8_arm64.h
	-$(RM) usb_0xA1_2_arm64.bin
	-$(RM) usb_0xA1_2_arm64.o
	-$(RM) usb_0xA1_2_arm64.h
	-$(RM) patch_rom.bin
	-$(RM) patch_rom.o
	-$(RM) patch_rom.h
	
